<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Fri Oct 30 20:47:49 CET 2015 -->
<title>UserLimitedBlockingPolicy</title>
<meta name="date" content="2015-10-30">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="UserLimitedBlockingPolicy";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/UserLimitedBlockingPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../uws/service/wait/WaitObserver.html" title="class in uws.service.wait"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?uws/service/wait/UserLimitedBlockingPolicy.html" target="_top">Frames</a></li>
<li><a href="UserLimitedBlockingPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">uws.service.wait</div>
<h2 title="Class UserLimitedBlockingPolicy" class="title">Class UserLimitedBlockingPolicy</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait">uws.service.wait.LimitedBlockingPolicy</a></li>
<li>
<ul class="inheritance">
<li>uws.service.wait.UserLimitedBlockingPolicy</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait">BlockingPolicy</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">UserLimitedBlockingPolicy</span>
extends <a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait">LimitedBlockingPolicy</a></pre>
<div class="block"><p>This <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> extends the <a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait"><code>LimitedBlockingPolicy</code></a>. So, it proposes to limit the blocking duration
 but it especially limits the number of blocked threads for a given job and user.</p>
 
 <h3>Blocked by Job AND User</h3>
 
 <p>
        As said, the limit on the number of threads is set ONLY for a given job AND a given user. Thus, an attempt to
        access the same job with the blocking behavior is limited but even if the limit is reached the same user can
        benefit from the blocking behavior with another job. Similarly a different user can access to the same job
        even if the limit is reached for another user.
 </p>
 
 <p><i>Note:
        If no user is identified, the IP address will be used instead.
 </i></p>
 
 <h3>What happens when the limit is reached?</h3>
 
 <p>In a such case, 2 strategies are proposed:</p>
 <ul>
        <li>unblock the oldest blocked thread and accept the new blocking</li>
        <li>do not block for the new asked blocking (then <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#block(java.lang.Thread,%20long,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)"><code>block(Thread, long, UWSJob, JobOwner, HttpServletRequest)</code></a> will return 0)</li>
 </ul>
 
 <p>
        The strategy to use MUST be specified at creation using <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#UserLimitedBlockingPolicy(long,%20int,%20boolean)"><code>UserLimitedBlockingPolicy(long, int, boolean)</code></a>
        with a third parameter set to <code>true</code> to unblock the oldest thread if needed, or <code>false</code>
        to prevent blocking if the limit is reached.
 </p></div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>4.2</dd>
<dt><span class="strong">Version:</span></dt>
  <dd>4.2 (10/2015)</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Gr&eacute;gory Mantelet (ARI)</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.Map&lt;java.lang.String,java.util.concurrent.BlockingQueue&lt;java.lang.Thread&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#blockedThreads">blockedThreads</a></strong></code>
<div class="block">List of all blocked threads.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#DEFAULT_NB_MAX_BLOCKED">DEFAULT_NB_MAX_BLOCKED</a></strong></code>
<div class="block">Default number of allowed blocked threads.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#maxBlockedThreadsByUser">maxBlockedThreadsByUser</a></strong></code>
<div class="block">The maximum number of blocked thread for a given job and user.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#unblockOld">unblockOld</a></strong></code>
<div class="block">Indicate what should happen when the maximum number of threads for a given job and user is reached.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_uws.service.wait.LimitedBlockingPolicy">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;uws.service.wait.<a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait">LimitedBlockingPolicy</a></h3>
<code><a href="../../../uws/service/wait/LimitedBlockingPolicy.html#DEFAULT_TIMEOUT">DEFAULT_TIMEOUT</a>, <a href="../../../uws/service/wait/LimitedBlockingPolicy.html#timeout">timeout</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#UserLimitedBlockingPolicy()">UserLimitedBlockingPolicy</a></strong>()</code>
<div class="block">Build a default <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#UserLimitedBlockingPolicy(long)">UserLimitedBlockingPolicy</a></strong>(long&nbsp;timeout)</code>
<div class="block">Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the default value
 (i.e.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#UserLimitedBlockingPolicy(long,%20int)">UserLimitedBlockingPolicy</a></strong>(long&nbsp;timeout,
                         int&nbsp;maxNbBlocked)</code>
<div class="block">Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the given value.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#UserLimitedBlockingPolicy(long,%20int,%20boolean)">UserLimitedBlockingPolicy</a></strong>(long&nbsp;timeout,
                         int&nbsp;maxNbBlocked,
                         boolean&nbsp;unblockOld)</code>
<div class="block">Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the given value.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#block(java.lang.Thread,%20long,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">block</a></strong>(java.lang.Thread&nbsp;thread,
     long&nbsp;userDuration,
     <a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
     <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
     javax.servlet.http.HttpServletRequest&nbsp;request)</code>
<div class="block">Notify this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> that the given thread is going to be blocked for the specified duration.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#buildKey(uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">buildKey</a></strong>(<a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
        <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
        javax.servlet.http.HttpServletRequest&nbsp;request)</code>
<div class="block">Build the key for the map <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#blockedThreads"><code>blockedThreads</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#unblocked(java.lang.Thread,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">unblocked</a></strong>(java.lang.Thread&nbsp;unblockedThread,
         <a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
         <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
         javax.servlet.http.HttpServletRequest&nbsp;request)</code>
<div class="block">Notify this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> that the given thread is not blocked anymore.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT_NB_MAX_BLOCKED">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_NB_MAX_BLOCKED</h4>
<pre>public static final&nbsp;int DEFAULT_NB_MAX_BLOCKED</pre>
<div class="block">Default number of allowed blocked threads.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#uws.service.wait.UserLimitedBlockingPolicy.DEFAULT_NB_MAX_BLOCKED">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="maxBlockedThreadsByUser">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxBlockedThreadsByUser</h4>
<pre>protected final&nbsp;int maxBlockedThreadsByUser</pre>
<div class="block">The maximum number of blocked thread for a given job and user.</div>
</li>
</ul>
<a name="blockedThreads">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>blockedThreads</h4>
<pre>protected final&nbsp;java.util.Map&lt;java.lang.String,java.util.concurrent.BlockingQueue&lt;java.lang.Thread&gt;&gt; blockedThreads</pre>
<div class="block">List of all blocked threads.
 Keys are an ID identifying a given job AND a given user
 (basically: jobId+";"+userId ;  see <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#buildKey(uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)"><code>buildKey(UWSJob, JobOwner, HttpServletRequest)</code></a> for more details).
 Values are fixed-length queues of blocked threads.</div>
</li>
</ul>
<a name="unblockOld">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>unblockOld</h4>
<pre>protected final&nbsp;boolean unblockOld</pre>
<div class="block">Indicate what should happen when the maximum number of threads for a given job and user is reached.
 <code>true</code> to unblock the oldest blocked thread in order to allow the new blocking.
 <code>false</code> to forbid new blocking.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="UserLimitedBlockingPolicy()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>UserLimitedBlockingPolicy</h4>
<pre>public&nbsp;UserLimitedBlockingPolicy()</pre>
<div class="block"><p>Build a default <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a>.</p>
 
 <p>
        This instance will limit the number of blocked threads by user and job to the default
        value (i.e. <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#DEFAULT_NB_MAX_BLOCKED">3</a>) and will limit the blocking duration to the default timeout
        (see <a href="../../../uws/service/wait/LimitedBlockingPolicy.html#DEFAULT_TIMEOUT"><code>LimitedBlockingPolicy.DEFAULT_TIMEOUT</code></a>).
 </p>
 
 <p>When the limit of threads is reached, the oldest thread is unblocked in order to allow the new incoming blocking.</p></div>
</li>
</ul>
<a name="UserLimitedBlockingPolicy(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>UserLimitedBlockingPolicy</h4>
<pre>public&nbsp;UserLimitedBlockingPolicy(long&nbsp;timeout)</pre>
<div class="block"><p>Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the default value
 (i.e. <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#DEFAULT_NB_MAX_BLOCKED">3</a>).</p>
 
 <p>When the limit of threads is reached, the oldest thread is unblocked in order to allow the new incoming blocking.</p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - Maximum blocking duration (in seconds).
                <i>If &lt; 0, the default timeout (see <a href="../../../uws/service/wait/LimitedBlockingPolicy.html#DEFAULT_TIMEOUT"><code>LimitedBlockingPolicy.DEFAULT_TIMEOUT</code></a>) will be set.
                If 0, no blocking will ever be performed.</i></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../uws/service/wait/LimitedBlockingPolicy.html#LimitedBlockingPolicy(long)"><code>LimitedBlockingPolicy.LimitedBlockingPolicy(long)</code></a></dd></dl>
</li>
</ul>
<a name="UserLimitedBlockingPolicy(long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>UserLimitedBlockingPolicy</h4>
<pre>public&nbsp;UserLimitedBlockingPolicy(long&nbsp;timeout,
                         int&nbsp;maxNbBlocked)</pre>
<div class="block"><p>Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the given value.</p>
 
 <p>When the limit of threads is reached, the oldest thread is unblocked in order to allow the new incoming blocking.</p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - Maximum blocking duration (in seconds).
                        <i>If &lt; 0, the default timeout (see <a href="../../../uws/service/wait/LimitedBlockingPolicy.html#DEFAULT_TIMEOUT"><code>LimitedBlockingPolicy.DEFAULT_TIMEOUT</code></a>) will be set.
                        If 0, no blocking will ever be performed.</i></dd><dd><code>maxNbBlocked</code> - Maximum number of blocked threads allowed for a given job and a given user.
                        <i>If &le; 0, this parameter will be ignored and the default value
                        (i.e. <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#DEFAULT_NB_MAX_BLOCKED">3</a>) will be set instead.</i></dd></dl>
</li>
</ul>
<a name="UserLimitedBlockingPolicy(long, int, boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>UserLimitedBlockingPolicy</h4>
<pre>public&nbsp;UserLimitedBlockingPolicy(long&nbsp;timeout,
                         int&nbsp;maxNbBlocked,
                         boolean&nbsp;unblockOld)</pre>
<div class="block"><p>Build a <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html" title="class in uws.service.wait"><code>UserLimitedBlockingPolicy</code></a> which will limits the blocking duration to the given value
 and will limit the number of blocked threads by job and user to the given value.</p>
 
 <p>
        When the limit of threads is reached, the oldest thread is unblocked if the 3rd parameter is <code>true</code>,
        or new incoming blocking will be forbidden if this parameter is <code>false</code>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - Maximum blocking duration (in seconds).
                        <i>If &lt; 0, the default timeout (see <a href="../../../uws/service/wait/LimitedBlockingPolicy.html#DEFAULT_TIMEOUT"><code>LimitedBlockingPolicy.DEFAULT_TIMEOUT</code></a>) will be set.
                        If 0, no blocking will ever be performed.</i></dd><dd><code>maxNbBlocked</code> - Maximum number of blocked threads allowed for a given job and a given user.
                        <i>If &le; 0, this parameter will be ignored and the default value
                        (i.e. <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#DEFAULT_NB_MAX_BLOCKED">3</a>) will be set instead.</i></dd><dd><code>unblockOld</code> - Set the behavior to adopt when the maximum number of threads is reached for a given job and user.
                        <code>true</code> to unblock the oldest thread in order to allow the new incoming blocking,
                        <code>false</code> to forbid the new incoming blocking.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="buildKey(uws.job.UWSJob, uws.job.user.JobOwner, javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>buildKey</h4>
<pre>protected final&nbsp;java.lang.String&nbsp;buildKey(<a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
                        <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
                        javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block"><p>Build the key for the map <a href="../../../uws/service/wait/UserLimitedBlockingPolicy.html#blockedThreads"><code>blockedThreads</code></a>.</p>
 
 <p>The built key is basically: jobId + ";" + userId.</p>
 
 <p><i>Note:
        If no user is logged in or if the user is not specified here or if it does not have any ID, the IP address
        of the HTTP client will be used instead.
 </i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>job</code> - Job associated with the request to block.
                        <b>MUST NOT be NULL.</b></dd><dd><code>user</code> - User who asked the blocking behavior.
                        <i>If NULL (or it has a NULL ID), the IP address of the HTTP client will be used.</i></dd><dd><code>request</code> - HTTP request which should be blocked.
                <i>SHOULD NOT be NULL.</i></dd>
<dt><span class="strong">Returns:</span></dt><dd>The corresponding map key.
                <i>NEVER NULL.</i></dd></dl>
</li>
</ul>
<a name="block(java.lang.Thread, long, uws.job.UWSJob, uws.job.user.JobOwner, javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>block</h4>
<pre>public&nbsp;long&nbsp;block(java.lang.Thread&nbsp;thread,
         long&nbsp;userDuration,
         <a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
         <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
         javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../uws/service/wait/BlockingPolicy.html#block(java.lang.Thread,%20long,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">BlockingPolicy</a></code></strong></div>
<div class="block"><p>Notify this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> that the given thread is going to be blocked for the specified duration.
 This function then decides how long the given thread must wait before resuming.</p>
 
 <p>
        The parameter "userDuration" (1st) and the returned value are durations expressed in seconds.
        Both follow the same rules:
 </p>
 <ul>
        <li><u>If &lt; 0</u>, the request will wait theoretically indefinitely.</li>
        <li><u>If 0</u>, the request will return immediately ; no wait.</li>
        <li><u>If &gt; 0</u>, the request will wait the specified amount of seconds.</li>
 </ul>
 
 <p>
        Since a timeout or another special behavior may be chosen by this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a>, the returned value may
        be different from the user's asked duration. The value that should be taken into account is obviously the returned
        one.
 </p>
 
 <p><i><b>IMPORTANT:</b>
        This function may <b>UN</b>block an older one, in function of
        the strategy chosen/implemented by this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a>.
 </i></p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../uws/service/wait/BlockingPolicy.html#block(java.lang.Thread,%20long,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">block</a></code>&nbsp;in interface&nbsp;<code><a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait">BlockingPolicy</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../uws/service/wait/LimitedBlockingPolicy.html#block(java.lang.Thread,%20long,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">block</a></code>&nbsp;in class&nbsp;<code><a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait">LimitedBlockingPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>thread</code> - Thread that is going to be blocked.
                      <i>MUST NOT be NULL. If NULL this function will either do nothing and return 0 (no blocking)
                      or throw a <code>NullPointerException</code>.</i></dd><dd><code>userDuration</code> - Waiting duration (in seconds) asked by the user.
                        <i>&lt; 0 means indefinite, 0 means no wait and &gt0; means waiting the specified amount of seconds.</i></dd><dd><code>job</code> - The job associated with the thread.
                                <i>Should not be NULL.</i></dd><dd><code>user</code> - The user who asked for the blocking behavior.
                                <i>If NULL, the request will be concerned as anonymous and a decision to identify the user
                                (e.g. use the IP address) may be chosen by the <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> implementation if required.</i></dd><dd><code>request</code> - The request which is going to be blocked.
                        <i>Should not be NULL.</i></dd>
<dt><span class="strong">Returns:</span></dt><dd>The real duration (in seconds) that the UWS service must wait before returning a response to the given HTTP request.
                <i>&lt; 0 means indefinite, 0 means no wait and &gt0; means waiting the specified amount of seconds.</i></dd></dl>
</li>
</ul>
<a name="unblocked(java.lang.Thread, uws.job.UWSJob, uws.job.user.JobOwner, javax.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>unblocked</h4>
<pre>public&nbsp;void&nbsp;unblocked(java.lang.Thread&nbsp;unblockedThread,
             <a href="../../../uws/job/UWSJob.html" title="class in uws.job">UWSJob</a>&nbsp;job,
             <a href="../../../uws/job/user/JobOwner.html" title="interface in uws.job.user">JobOwner</a>&nbsp;user,
             javax.servlet.http.HttpServletRequest&nbsp;request)</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../../uws/service/wait/BlockingPolicy.html#unblocked(java.lang.Thread,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">BlockingPolicy</a></code></strong></div>
<div class="block">Notify this <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> that the given thread is not blocked anymore.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../uws/service/wait/BlockingPolicy.html#unblocked(java.lang.Thread,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">unblocked</a></code>&nbsp;in interface&nbsp;<code><a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait">BlockingPolicy</a></code></dd>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../uws/service/wait/LimitedBlockingPolicy.html#unblocked(java.lang.Thread,%20uws.job.UWSJob,%20uws.job.user.JobOwner,%20javax.servlet.http.HttpServletRequest)">unblocked</a></code>&nbsp;in class&nbsp;<code><a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait">LimitedBlockingPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>unblockedThread</code> - Thread that is not blocked any more.
                        <b>MUST be NOT NULL.</b></dd><dd><code>job</code> - The job associated with the unblocked Thread.
                                        <i>Should not be NULL.</i></dd><dd><code>user</code> - The user who originally asked for the blocking behavior.
                                        <i>If NULL, the request will be concerned as anonymous and a decision to identify the user
                                        (e.g. use the IP address) may be chosen by the <a href="../../../uws/service/wait/BlockingPolicy.html" title="interface in uws.service.wait"><code>BlockingPolicy</code></a> implementation if required.</i></dd><dd><code>request</code> - The request which has been unblocked.
                                <i>Should not be NULL.</i></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/UserLimitedBlockingPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../uws/service/wait/LimitedBlockingPolicy.html" title="class in uws.service.wait"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../uws/service/wait/WaitObserver.html" title="class in uws.service.wait"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?uws/service/wait/UserLimitedBlockingPolicy.html" target="_top">Frames</a></li>
<li><a href="UserLimitedBlockingPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
