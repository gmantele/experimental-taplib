<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_95) on Fri Jan 29 20:29:45 CET 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ADQLExecutor</title>
<meta name="date" content="2016-01-29">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ADQLExecutor";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ADQLExecutor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../tap/AbstractTAPFactory.html" title="class in tap"><span class="strong">Prev Class</span></a></li>
<li><a href="../tap/AsyncThread.html" title="class in tap"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?tap/ADQLExecutor.html" target="_top">Frames</a></li>
<li><a href="ADQLExecutor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">tap</div>
<h2 title="Class ADQLExecutor" class="title">Class ADQLExecutor</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>tap.ADQLExecutor</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">ADQLExecutor</span>
extends java.lang.Object</pre>
<div class="block"><p>Let process completely an ADQL query.</p>
 
 <p>Thus, this class aims to apply the following actions (in the given order):</p>
 <ol>
        <li>Upload the user tables, if any</li>
        <li>Parse the ADQL query (and so, transform it in an object tree)</li>
        <li>Execute it in the "database"</li>
        <li>Format and write the result</li>
        <li>Drop all uploaded tables from the "database"</li>
 </ol>
 
 <h3>Job execution mode</h3>
 
 <p>
        This executor is able to process queries coming from a synchronous job (the result must be written directly in the HTTP response)
        and from an asynchronous job (the result must be written, generally, in a file). Two start(...) functions let deal with
        the differences between the two job execution modes: <a href="../tap/ADQLExecutor.html#start(tap.AsyncThread)"><code>start(AsyncThread)</code></a> for asynchronous jobs
        and <a href="../tap/ADQLExecutor.html#start(java.lang.Thread,%20java.lang.String,%20tap.parameters.TAPParameters,%20javax.servlet.http.HttpServletResponse)"><code>start(Thread, String, TAPParameters, HttpServletResponse)</code></a> for synchronous jobs.
 </p>
 
 <h3>Input/Output formats</h3>
 
 <p>Uploaded tables must be provided in VOTable format.</p>
 
 <p>
        Query results must be formatted in the format specified by the user in the job parameters. A corresponding formatter (<a href="../tap/formatter/OutputFormat.html" title="interface in tap.formatter"><code>OutputFormat</code></a>)
        is asked to the description of the TAP service (<a href="../tap/ServiceConnection.html" title="interface in tap"><code>ServiceConnection</code></a>). If none can be found, VOTable will be chosen by default.
 </p>
 
 <h3>Executor customization</h3>
 
 <p>It is totally possible to customize some parts of the ADQL query processing. However, the main algorithm must remain the same and is implemented
        by <a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a>. This function is final, like <a href="../tap/ADQLExecutor.html#start(tap.AsyncThread)"><code>start(AsyncThread)</code></a> and <a href="../tap/ADQLExecutor.html#start(java.lang.Thread,%20java.lang.String,%20tap.parameters.TAPParameters,%20javax.servlet.http.HttpServletResponse)"><code>start(Thread, String, TAPParameters, HttpServletResponse)</code></a>,
        which are just preparing the execution for <a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a> in function of the job execution mode (asynchronous or synchronous).
 </p>
 
 <p><i>Note:
        <a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a> is using the Template Method Design Pattern: it defines the skeleton/algorithm of the processing, and defers some steps
        to other functions.
 </i></p> 
 
 <p>
        So, you are able to customize almost all individual steps of the ADQL query processing: <a href="../tap/ADQLExecutor.html#parseADQL()"><code>parseADQL()</code></a>, <a href="../tap/ADQLExecutor.html#executeADQL(adql.query.ADQLQuery)"><code>executeADQL(ADQLQuery)</code></a> and
        <a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator,%20tap.formatter.OutputFormat,%20java.io.OutputStream)"><code>writeResult(TableIterator, OutputFormat, OutputStream)</code></a>.
 </p>
 
 <p><i>Note:
        Note that the formatting of the result is done by an OutputFormat and that the executor is just calling the appropriate function of the formatter.
 </i></p>
 
 <p>
        There is no way in this executor to customize the upload. However, it does not mean it can not be customized.
        Indeed you can do it easily by extending <a href="../tap/upload/Uploader.html" title="class in tap.upload"><code>Uploader</code></a> and by providing the new class inside your <a href="../tap/TAPFactory.html" title="class in tap"><code>TAPFactory</code></a> implementation
 (see <a href="../tap/TAPFactory.html#createUploader(tap.db.DBConnection)"><code>TAPFactory.createUploader(DBConnection)</code></a>).
 </p></div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>2.1 (11/2015)</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Gr&eacute;gory Mantelet (CDS;ARI)</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/log/TAPLog.html" title="interface in tap.log">TAPLog</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#logger">logger</a></strong></code>
<div class="block">The logger to use.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#report">report</a></strong></code>
<div class="block">The execution report to fill gradually while the processing of the query.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected javax.servlet.http.HttpServletResponse</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#response">response</a></strong></code>
<div class="block">The HTTP response in which the query execution must be written.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#service">service</a></strong></code>
<div class="block">Description of the current TAP service.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/parameters/TAPParameters.html" title="class in tap.parameters">TAPParameters</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#tapParams">tapParams</a></strong></code>
<div class="block">List of all TAP parameters needed for the query execution (and particularly the ADQL query itself).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.lang.Thread</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#thread">thread</a></strong></code>
<div class="block">The thread which is using this executor.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/metadata/TAPSchema.html" title="class in tap.metadata">TAPSchema</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#uploadSchema">uploadSchema</a></strong></code>
<div class="block">Description of the ADQL schema containing all the tables uploaded by the user for this specific query execution.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../tap/ADQLExecutor.html#ADQLExecutor(tap.ServiceConnection)">ADQLExecutor</a></strong>(<a href="../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service)</code>
<div class="block">Build an <a href="../tap/ADQLExecutor.html" title="class in tap"><code>ADQLExecutor</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#cancelQuery()">cancelQuery</a></strong>()</code>
<div class="block">Cancel the current SQL query execution or result set fetching if any is currently running.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#dropUploadedTables()">dropUploadedTables</a></strong>()</code>
<div class="block">Drop all tables uploaded by the user from the database.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#executeADQL(adql.query.ADQLQuery)">executeADQL</a></strong>(<a href="../adql/query/ADQLQuery.html" title="class in adql.query">ADQLQuery</a>&nbsp;adql)</code>
<div class="block">Execute in "database" the given object representation of an ADQL query.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#getExecReport()">getExecReport</a></strong>()</code>
<div class="block">Get the report of the query execution.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#getFormatter()">getFormatter</a></strong>()</code>
<div class="block">Get the object to use in order to write the query result in the appropriate format
 (either the asked one, or else VOTable).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../tap/log/TAPLog.html" title="interface in tap.log">TAPLog</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#getLogger()">getLogger</a></strong>()</code>
<div class="block">Get the logger used by this executor.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#initDBConnection(java.lang.String)">initDBConnection</a></strong>(java.lang.String&nbsp;jobID)</code>
<div class="block">Create the database connection required for the ADQL execution.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../adql/query/ADQLQuery.html" title="class in adql.query">ADQLQuery</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#parseADQL()">parseADQL</a></strong>()</code>
<div class="block">Parse the ADQL query provided in the parameters by the user.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#start()">start</a></strong>()</code>
<div class="block">Process the ADQL query.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#start(tap.AsyncThread)">start</a></strong>(<a href="../tap/AsyncThread.html" title="class in tap">AsyncThread</a>&nbsp;thread)</code>
<div class="block">Start the asynchronous processing of the ADQL query.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a></code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#start(java.lang.Thread,%20java.lang.String,%20tap.parameters.TAPParameters,%20javax.servlet.http.HttpServletResponse)">start</a></strong>(java.lang.Thread&nbsp;thread,
     java.lang.String&nbsp;jobId,
     <a href="../tap/parameters/TAPParameters.html" title="class in tap.parameters">TAPParameters</a>&nbsp;params,
     javax.servlet.http.HttpServletResponse&nbsp;response)</code>
<div class="block">Start the synchronous processing of the ADQL query.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator)">writeResult</a></strong>(<a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult)</code>
<div class="block">Write the given query result into the appropriate format in the appropriate output
 (HTTP response for a synchronous execution, otherwise a file or any output provided by UWS).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator,%20tap.formatter.OutputFormat,%20java.io.OutputStream)">writeResult</a></strong>(<a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult,
           <a href="../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a>&nbsp;formatter,
           java.io.OutputStream&nbsp;output)</code>
<div class="block">Format and write the given result in the given output with the given formatter.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="service">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>service</h4>
<pre>protected final&nbsp;<a href="../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a> service</pre>
<div class="block">Description of the current TAP service.</div>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>protected final&nbsp;<a href="../tap/log/TAPLog.html" title="interface in tap.log">TAPLog</a> logger</pre>
<div class="block">The logger to use.</div>
</li>
</ul>
<a name="thread">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>thread</h4>
<pre>protected&nbsp;java.lang.Thread thread</pre>
<div class="block">The thread which is using this executor.</div>
</li>
</ul>
<a name="tapParams">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tapParams</h4>
<pre>protected&nbsp;<a href="../tap/parameters/TAPParameters.html" title="class in tap.parameters">TAPParameters</a> tapParams</pre>
<div class="block">List of all TAP parameters needed for the query execution (and particularly the ADQL query itself).</div>
</li>
</ul>
<a name="uploadSchema">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uploadSchema</h4>
<pre>protected&nbsp;<a href="../tap/metadata/TAPSchema.html" title="class in tap.metadata">TAPSchema</a> uploadSchema</pre>
<div class="block">Description of the ADQL schema containing all the tables uploaded by the user for this specific query execution.
 <i>Note: This attribute is NULL before calling one of the start(...) function. It MAY be NULL also after if no table has been uploaded.</i></div>
</li>
</ul>
<a name="response">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>response</h4>
<pre>protected&nbsp;javax.servlet.http.HttpServletResponse response</pre>
<div class="block">The HTTP response in which the query execution must be written. This attribute is NULL if the execution is asynchronous.</div>
</li>
</ul>
<a name="report">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>report</h4>
<pre>protected&nbsp;<a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a> report</pre>
<div class="block">The execution report to fill gradually while the processing of the query.
 <i>Note: This attribute is NULL before calling one of the start(...) function, but it will never be after this call.</i></div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ADQLExecutor(tap.ServiceConnection)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ADQLExecutor</h4>
<pre>public&nbsp;ADQLExecutor(<a href="../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service)</pre>
<div class="block">Build an <a href="../tap/ADQLExecutor.html" title="class in tap"><code>ADQLExecutor</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>service</code> - The description of the TAP service.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getLogger()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLogger</h4>
<pre>public final&nbsp;<a href="../tap/log/TAPLog.html" title="interface in tap.log">TAPLog</a>&nbsp;getLogger()</pre>
<div class="block">Get the logger used by this executor.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The used logger.</dd></dl>
</li>
</ul>
<a name="getExecReport()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExecReport</h4>
<pre>public final&nbsp;<a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;getExecReport()</pre>
<div class="block"><p>Get the report of the query execution. It helps indicating the execution progression and the duration of each step.</p>
 
 <p><i>Note:
        Before starting the execution (= before the call of a "start(...)" function), this function will return NULL.
        It is set when the query processing starts and remains not NULL after that (even when the execution is finished).
 </i></p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The execution report.</dd></dl>
</li>
</ul>
<a name="getFormatter()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFormatter</h4>
<pre>protected&nbsp;<a href="../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a>&nbsp;getFormatter()
                             throws <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Get the object to use in order to write the query result in the appropriate format
 (either the asked one, or else VOTable).</p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The appropriate result formatter to use. <i>Can not be NULL!</i></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If no format corresponds to the asked one and if no default format (for VOTable) can be found.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../tap/ServiceConnection.html#getOutputFormat(java.lang.String)"><code>ServiceConnection.getOutputFormat(String)</code></a></dd></dl>
</li>
</ul>
<a name="start(tap.AsyncThread)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public final&nbsp;<a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;start(<a href="../tap/AsyncThread.html" title="class in tap">AsyncThread</a>&nbsp;thread)
                               throws <a href="../uws/UWSException.html" title="class in uws">UWSException</a>,
                                      java.lang.InterruptedException</pre>
<div class="block"><p>Start the asynchronous processing of the ADQL query.</p>
 
 <p>
        This function initialize the execution report, get the execution parameters (including the query to process)
        and then call <a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>thread</code> - The asynchronous thread which asks the query processing.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The resulting execution report.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../uws/UWSException.html" title="class in uws">UWSException</a></code> - If any error occurs while executing the ADQL query.</dd>
<dd><code>java.lang.InterruptedException</code> - If the job has been interrupted (by the user or a time-out).</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a></dd></dl>
</li>
</ul>
<a name="initDBConnection(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initDBConnection</h4>
<pre>public final&nbsp;void&nbsp;initDBConnection(java.lang.String&nbsp;jobID)
                            throws <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Create the database connection required for the ADQL execution.</p>
 
 <p><i>Note: This function has no effect if the DB connection already exists.</i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>jobID</code> - ID of the job which will be executed by this <a href="../tap/ADQLExecutor.html" title="class in tap"><code>ADQLExecutor</code></a>.
                This ID will be the database connection ID.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If the DB connection creation fails.</dd><dt><span class="strong">Since:</span></dt>
  <dd>2.0</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../tap/TAPFactory.html#getConnection(java.lang.String)"><code>TAPFactory.getConnection(String)</code></a></dd></dl>
</li>
</ul>
<a name="cancelQuery()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cancelQuery</h4>
<pre>public final&nbsp;void&nbsp;cancelQuery()</pre>
<div class="block">Cancel the current SQL query execution or result set fetching if any is currently running.
 If no such process is on going, this function has no effect.</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>2.1</dd></dl>
</li>
</ul>
<a name="start(java.lang.Thread, java.lang.String, tap.parameters.TAPParameters, javax.servlet.http.HttpServletResponse)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public final&nbsp;<a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;start(java.lang.Thread&nbsp;thread,
                       java.lang.String&nbsp;jobId,
                       <a href="../tap/parameters/TAPParameters.html" title="class in tap.parameters">TAPParameters</a>&nbsp;params,
                       javax.servlet.http.HttpServletResponse&nbsp;response)
                               throws <a href="../tap/TAPException.html" title="class in tap">TAPException</a>,
                                      java.io.IOException,
                                      java.lang.InterruptedException</pre>
<div class="block"><p>Start the synchronous processing of the ADQL query.</p>
 
 <p>This function initialize the execution report and then call <a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a>.</p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>thread</code> - The synchronous thread which asks the query processing.</dd><dd><code>jobId</code> - ID of the corresponding job.</dd><dd><code>params</code> - All execution parameters (including the query to process).</dd><dd><code>response</code> - Object in which the result or the error must be written.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The resulting execution report.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If any error occurs while executing the ADQL query.</dd>
<dd><code>java.io.IOException</code> - If any error occurs while writing the result in the given <code>HttpServletResponse</code>.</dd>
<dd><code>java.lang.InterruptedException</code> - If the job has been interrupted (by the user or a time-out).</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../tap/ADQLExecutor.html#start()"><code>start()</code></a></dd></dl>
</li>
</ul>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>protected final&nbsp;<a href="../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;start()
                                  throws <a href="../tap/TAPException.html" title="class in tap">TAPException</a>,
                                         <a href="../uws/UWSException.html" title="class in uws">UWSException</a>,
                                         java.io.IOException,
                                         java.lang.InterruptedException</pre>
<div class="block"><p>Process the ADQL query.</p>
 
 <p>This function calls the following function (in the same order):</p>
 <ol>
        <li><a href="../tap/TAPFactory.html#getConnection(java.lang.String)"><code>TAPFactory.getConnection(String)</code></a></li>
        <li><a href="../tap/ADQLExecutor.html#uploadTables()"><code>uploadTables()</code></a></li>
        <li><a href="../tap/ADQLExecutor.html#parseADQL()"><code>parseADQL()</code></a></li>
        <li><a href="../tap/ADQLExecutor.html#executeADQL(adql.query.ADQLQuery)"><code>executeADQL(ADQLQuery)</code></a></li>
        <li><a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator)"><code>writeResult(TableIterator)</code></a></li>
        <li><a href="../tap/ADQLExecutor.html#dropUploadedTables()"><code>dropUploadedTables()</code></a></li>
        <li><a href="../tap/TAPFactory.html#freeConnection(tap.db.DBConnection)"><code>TAPFactory.freeConnection(DBConnection)</code></a></li>
 </ol>
 
 <p>
        The execution report is updated gradually. Besides a job parameter - progression - is set at each step of the process in order to
        notify the user of the progression of the query execution. This parameter is removed at the end of the execution if it is successful.
 </p>
 
 <p>The "interrupted" flag of the associated thread is often tested so that stopping the execution as soon as possible.</p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The updated execution report.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If any error occurs while executing the ADQL query.</dd>
<dd><code><a href="../uws/UWSException.html" title="class in uws">UWSException</a></code> - If any error occurs while executing the ADQL query.</dd>
<dd><code>java.io.IOException</code> - If an error happens while writing the result in the specified <code>HttpServletResponse</code>.
                                        <i>That kind of error can be thrown only in synchronous mode.
                                        In asynchronous, the error is stored as job error report and is never propagated.</i></dd>
<dd><code>java.lang.InterruptedException</code> - If the job has been interrupted (by the user or a time-out).</dd></dl>
</li>
</ul>
<a name="parseADQL()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseADQL</h4>
<pre>protected&nbsp;<a href="../adql/query/ADQLQuery.html" title="class in adql.query">ADQLQuery</a>&nbsp;parseADQL()
                       throws <a href="../adql/parser/ParseException.html" title="class in adql.parser">ParseException</a>,
                              java.lang.InterruptedException,
                              <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Parse the ADQL query provided in the parameters by the user.</p>
 
 <p>The query factory and the query checker are got from the TAP factory.</p>
 
 <p>
        The configuration of this TAP service list all allowed coordinate systems. These are got here and provided to the query checker
        in order to ensure the coordinate systems used in the query are in this list.
 </p>
 
 <p>
        The row limit specified in the ADQL query (with TOP) is checked and adjusted (if needed). Indeed, this limit
        can not exceed MAXREC given in parameter and the maximum value specified in the configuration of this TAP service.
        In the case no row limit is specified in the query or the given value is greater than MAXREC, (MAXREC+1) is used by default.
        The "+1" aims to detect overflows.
 </p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The object representation of the ADQL query.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../adql/parser/ParseException.html" title="class in adql.parser">ParseException</a></code> - If the given ADQL query can not be parsed or if the construction of the object representation has failed.</dd>
<dd><code>java.lang.InterruptedException</code> - If the thread has been interrupted.</dd>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If the TAP factory is unable to create the ADQL factory or the query checker.</dd></dl>
</li>
</ul>
<a name="executeADQL(adql.query.ADQLQuery)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>executeADQL</h4>
<pre>protected&nbsp;<a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;executeADQL(<a href="../adql/query/ADQLQuery.html" title="class in adql.query">ADQLQuery</a>&nbsp;adql)
                             throws java.lang.InterruptedException,
                                    <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Execute in "database" the given object representation of an ADQL query.</p>
 
 <p>By default, this function is just calling <a href="../tap/db/DBConnection.html#executeQuery(adql.query.ADQLQuery)"><code>DBConnection.executeQuery(ADQLQuery)</code></a> and then it returns the value returned by this call.</p>
 
 <p><i>Note:
        An INFO message is logged at the end of the query execution in order to report the result status (success or error)
        and the execution duration.
 </i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>adql</code> - The object representation of the ADQL query to execute.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The result of the query,
                or NULL if the query execution has failed.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code> - If the thread has been interrupted.</dd>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If the <a href="../tap/db/DBConnection.html" title="interface in tap.db"><code>DBConnection</code></a> has failed to deal with the given ADQL query.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../tap/db/DBConnection.html#executeQuery(adql.query.ADQLQuery)"><code>DBConnection.executeQuery(ADQLQuery)</code></a></dd></dl>
</li>
</ul>
<a name="writeResult(tap.data.TableIterator)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeResult</h4>
<pre>protected final&nbsp;void&nbsp;writeResult(<a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult)
                          throws java.lang.InterruptedException,
                                 java.io.IOException,
                                 <a href="../tap/TAPException.html" title="class in tap">TAPException</a>,
                                 <a href="../uws/UWSException.html" title="class in uws">UWSException</a></pre>
<div class="block"><p>Write the given query result into the appropriate format in the appropriate output
 (HTTP response for a synchronous execution, otherwise a file or any output provided by UWS).</p>
 
 <p>This function prepare the output in function of the execution type (synchronous or asynchronous).
        Once prepared, the result, the output and the formatter to use are given to <a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator,%20tap.formatter.OutputFormat,%20java.io.OutputStream)"><code>writeResult(TableIterator, OutputFormat, OutputStream)</code></a>
        which will really process the result formatting and writing.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>queryResult</code> - The result of the query execution in database.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code> - If the thread has been interrupted.</dd>
<dd><code>java.io.IOException</code> - If an error happens while writing the result in the <code>HttpServletResponse</code>.
                                        <i>That kind of error can be thrown only in synchronous mode.
                                        In asynchronous, the error is stored as job error report and is never propagated.</i></dd>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If an error occurs while getting the appropriate formatter or while formatting or writing (synchronous execution) the result.</dd>
<dd><code><a href="../uws/UWSException.html" title="class in uws">UWSException</a></code> - If an error occurs while getting the output stream or while writing (asynchronous execution) the result.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../tap/ADQLExecutor.html#writeResult(tap.data.TableIterator,%20tap.formatter.OutputFormat,%20java.io.OutputStream)"><code>writeResult(TableIterator, OutputFormat, OutputStream)</code></a></dd></dl>
</li>
</ul>
<a name="writeResult(tap.data.TableIterator, tap.formatter.OutputFormat, java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeResult</h4>
<pre>protected&nbsp;void&nbsp;writeResult(<a href="../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult,
               <a href="../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a>&nbsp;formatter,
               java.io.OutputStream&nbsp;output)
                    throws java.lang.InterruptedException,
                           java.io.IOException,
                           <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Format and write the given result in the given output with the given formatter.</p>
 
 <p>By default, this function is just calling <a href="../tap/formatter/OutputFormat.html#writeResult(tap.data.TableIterator,%20java.io.OutputStream,%20tap.TAPExecutionReport,%20java.lang.Thread)"><code>OutputFormat.writeResult(TableIterator, OutputStream, TAPExecutionReport, Thread)</code></a>.</p>
 
 <p><i>Note:
        <a href="../tap/formatter/OutputFormat.html#writeResult(tap.data.TableIterator,%20java.io.OutputStream,%20tap.TAPExecutionReport,%20java.lang.Thread)"><code>OutputFormat.writeResult(TableIterator, OutputStream, TAPExecutionReport, Thread)</code></a> is often testing the "interrupted" flag of the
        thread in order to stop as fast as possible if the user has cancelled the job or if the thread has been interrupted for another reason.
 </i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>queryResult</code> - Query result to format and to output.</dd><dd><code>formatter</code> - The object able to write the result in the appropriate format.</dd><dd><code>output</code> - The stream in which the result must be written.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code> - If the thread has been interrupted.</dd>
<dd><code>java.io.IOException</code> - If there is an error while writing the result in the given stream.</dd>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If there is an error while formatting the result.</dd></dl>
</li>
</ul>
<a name="dropUploadedTables()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>dropUploadedTables</h4>
<pre>protected&nbsp;void&nbsp;dropUploadedTables()
                           throws <a href="../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Drop all tables uploaded by the user from the database.</p>
 
 <p><i>Note:
        By default, if an error occurs while dropping a table from the database, the error will just be logged ; it won't be thrown/propagated.
 </i></p></div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../tap/TAPException.html" title="class in tap">TAPException</a></code> - If a grave error occurs. <i>By default, no exception is thrown ; they are just logged.</i></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ADQLExecutor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../tap/AbstractTAPFactory.html" title="class in tap"><span class="strong">Prev Class</span></a></li>
<li><a href="../tap/AsyncThread.html" title="class in tap"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?tap/ADQLExecutor.html" target="_top">Frames</a></li>
<li><a href="ADQLExecutor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
