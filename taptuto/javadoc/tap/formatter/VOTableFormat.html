<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_95) on Fri Jan 29 20:29:45 CET 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>VOTableFormat</title>
<meta name="date" content="2016-01-29">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="VOTableFormat";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/VOTableFormat.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../tap/formatter/TextFormat.html" title="class in tap.formatter"><span class="strong">Prev Class</span></a></li>
<li><a href="../../tap/formatter/VOTableFormat.LimitedStarTable.html" title="class in tap.formatter"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?tap/formatter/VOTableFormat.html" target="_top">Frames</a></li>
<li><a href="VOTableFormat.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">tap.formatter</div>
<h2 title="Class VOTableFormat" class="title">Class VOTableFormat</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>tap.formatter.VOTableFormat</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">VOTableFormat</span>
extends java.lang.Object
implements <a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></pre>
<div class="block"><p>Format any given query (table) result into VOTable.</p>
 
 <p>
        Format and version of the resulting VOTable can be provided in parameters at the construction time.
        This formatter is using STIL. So all formats and versions managed by STIL are also here.
        Basically, you have the following formats: TABLEDATA, BINARY, BINARY2 (only when using VOTable v1.3) and FITS.
        The versions are: 1.0, 1.1, 1.2 and 1.3.
 </p>
 
 <p>Note: The MIME type is automatically set in function of the given VOTable serialization:</p>
 <ul>
        <li><b>none or unknown</b>: equivalent to BINARY</li>
        <li><b>BINARY</b>:          "application/x-votable+xml" = "votable"</li>
        <li><b>BINARY2</b>:         "application/x-votable+xml;serialization=BINARY2" = "votable/b2"</li>
        <li><b>TABLEDATA</b>:       "application/x-votable+xml;serialization=TABLEDATA" = "votable/td"</li>
        <li><b>FITS</b>:            "application/x-votable+xml;serialization=FITS" = "votable/fits"</li>
 </ul>
 <p>It is however possible to change these default values thanks to <a href="../../tap/formatter/VOTableFormat.html#setMimeType(java.lang.String,%20java.lang.String)"><code>setMimeType(String, String)</code></a>.</p>
 
 <p>In addition of the INFO elements for QUERY_STATUS="OK" and QUERY_STATUS="OVERFLOW", two additional INFO elements are written:</p>
 <ul>
        <li>PROVIDER = <a href="../../tap/ServiceConnection.html#getProviderName()"><code>ServiceConnection.getProviderName()</code></a> and <a href="../../tap/ServiceConnection.html#getProviderDescription()"><code>ServiceConnection.getProviderDescription()</code></a></li>
        <li>QUERY = the ADQL query at the origin of this result.</li>
 </ul>
 
 <p>
        Furthermore, this formatter provides a function to format an error in VOTable: <a href="../../tap/formatter/VOTableFormat.html#writeError(java.lang.String,%20java.util.Map,%20java.io.PrintWriter)"><code>writeError(String, Map, PrintWriter)</code></a>.
        This is useful for TAP which requires to return in VOTable any error that occurs while any operation.
        <i>See <a href="../../tap/error/DefaultTAPErrorWriter.html" title="class in tap.error"><code>DefaultTAPErrorWriter</code></a> for more details.</i>
 </p></div>
<dl><dt><span class="strong">Version:</span></dt>
  <dd>2.1 (11/2015)</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Gr&eacute;gory Mantelet (CDS;ARI)</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.LimitedStarTable.html" title="class in tap.formatter">VOTableFormat.LimitedStarTable</a></strong></code>
<div class="block">
        Special <code>StarTable</code> able to read a fixed maximum number of rows <a href="../../tap/data/TableIterator.html" title="interface in tap.data"><code>TableIterator</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#mimeType">mimeType</a></strong></code>
<div class="block">MIME type associated with this format.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a></code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#service">service</a></strong></code>
<div class="block">The <a href="../../tap/ServiceConnection.html" title="interface in tap"><code>ServiceConnection</code></a> to use (for the log and to have some information about the service (particularly: name, description).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#shortMimeType">shortMimeType</a></strong></code>
<div class="block">Short form of the MIME type associated with this format.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected uk.ac.starlink.votable.DataFormat</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#votFormat">votFormat</a></strong></code>
<div class="block">Format of the VOTable data part in which data must be formatted.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected uk.ac.starlink.votable.VOTableVersion</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#votVersion">votVersion</a></strong></code>
<div class="block">VOTable version in which table data must be formatted.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../tap/formatter/VOTableFormat.html#VOTableFormat(tap.ServiceConnection)">VOTableFormat</a></strong>(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service)</code>
<div class="block">Creates a VOTable formatter.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../tap/formatter/VOTableFormat.html#VOTableFormat(tap.ServiceConnection,%20uk.ac.starlink.votable.DataFormat)">VOTableFormat</a></strong>(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service,
             uk.ac.starlink.votable.DataFormat&nbsp;votFormat)</code>
<div class="block">Creates a VOTable formatter.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../tap/formatter/VOTableFormat.html#VOTableFormat(tap.ServiceConnection,%20uk.ac.starlink.votable.DataFormat,%20uk.ac.starlink.votable.VOTableVersion)">VOTableFormat</a></strong>(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service,
             uk.ac.starlink.votable.DataFormat&nbsp;votFormat,
             uk.ac.starlink.votable.VOTableVersion&nbsp;votVersion)</code>
<div class="block">Creates a VOTable formatter.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static uk.ac.starlink.table.ColumnInfo</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getColumnInfo(tap.metadata.TAPColumn)">getColumnInfo</a></strong>(<a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a>&nbsp;tapCol)</code>
<div class="block">Convert the given <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata"><code>TAPColumn</code></a> object into a <code>ColumnInfo</code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.Class&lt;?&gt;</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getDatatypeClass(tap.metadata.VotType.VotDatatype,%20java.lang.String)">getDatatypeClass</a></strong>(<a href="../../tap/metadata/VotType.VotDatatype.html" title="enum in tap.metadata">VotType.VotDatatype</a>&nbsp;datatype,
                java.lang.String&nbsp;arraysize)</code>
<div class="block">Convert the VOTable datatype string into a corresponding <code>Class</code> object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getDescription()">getDescription</a></strong>()</code>
<div class="block">Gets a description of this format.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getFileExtension()">getFileExtension</a></strong>()</code>
<div class="block">Gets a file extension for this format.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getMimeType()">getMimeType</a></strong>()</code>
<div class="block">Gets the MIME type corresponding to this format.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static int[]</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getShape(java.lang.String)">getShape</a></strong>(java.lang.String&nbsp;arraysize)</code>
<div class="block">Convert the given VOTable arraysize into a <code>ColumnInfo</code> shape.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getShortMimeType()">getShortMimeType</a></strong>()</code>
<div class="block">Gets a short expression of its MIME type.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a></code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getValidColMeta(adql.db.DBColumn,%20tap.metadata.TAPColumn)">getValidColMeta</a></strong>(<a href="../../adql/db/DBColumn.html" title="interface in adql.db">DBColumn</a>&nbsp;typeFromQuery,
               <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a>&nbsp;typeFromResult)</code>
<div class="block">Try to get or otherwise to build appropriate metadata using those extracted from the ADQL query and those extracted from the result.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>uk.ac.starlink.votable.DataFormat</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getVotSerialization()">getVotSerialization</a></strong>()</code>
<div class="block">Get the set VOTable data serialization/format (e.g.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>uk.ac.starlink.votable.VOTableVersion</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#getVotVersion()">getVotVersion</a></strong>()</code>
<div class="block">Get the set VOTable version.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#setMimeType(java.lang.String,%20java.lang.String)">setMimeType</a></strong>(java.lang.String&nbsp;mimeType,
           java.lang.String&nbsp;shortForm)</code>
<div class="block">Set the MIME type associated with this format.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static uk.ac.starlink.table.ColumnInfo[]</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#toColumnInfos(tap.data.TableIterator,%20tap.TAPExecutionReport,%20java.lang.Thread)">toColumnInfos</a></strong>(<a href="../../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;result,
             <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
             java.lang.Thread&nbsp;thread)</code>
<div class="block">Writes fields' metadata of the given query result.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#writeError(java.lang.String,%20java.util.Map,%20java.io.PrintWriter)">writeError</a></strong>(java.lang.String&nbsp;message,
          java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;otherInfo,
          java.io.PrintWriter&nbsp;writer)</code>
<div class="block">Write the given error message as VOTable document.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#writeHeader(uk.ac.starlink.votable.VOTableVersion,%20tap.TAPExecutionReport,%20java.io.BufferedWriter)">writeHeader</a></strong>(uk.ac.starlink.votable.VOTableVersion&nbsp;votVersion,
           <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
           java.io.BufferedWriter&nbsp;out)</code>
<div class="block">Writes the first VOTable nodes/elements preceding the data: VOTABLE, RESOURCE and 3 INFOS (QUERY_STATUS, PROVIDER, QUERY).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../tap/formatter/VOTableFormat.html#writeResult(tap.data.TableIterator,%20java.io.OutputStream,%20tap.TAPExecutionReport,%20java.lang.Thread)">writeResult</a></strong>(<a href="../../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult,
           java.io.OutputStream&nbsp;output,
           <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
           java.lang.Thread&nbsp;thread)</code>
<div class="block">Formats the given query result and writes it in the given output stream.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="service">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>service</h4>
<pre>protected final&nbsp;<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a> service</pre>
<div class="block">The <a href="../../tap/ServiceConnection.html" title="interface in tap"><code>ServiceConnection</code></a> to use (for the log and to have some information about the service (particularly: name, description).</div>
</li>
</ul>
<a name="votFormat">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>votFormat</h4>
<pre>protected final&nbsp;uk.ac.starlink.votable.DataFormat votFormat</pre>
<div class="block">Format of the VOTable data part in which data must be formatted. Possible values are: TABLEDATA, BINARY, BINARY2 or FITS. By default, it is set to BINARY.</div>
</li>
</ul>
<a name="votVersion">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>votVersion</h4>
<pre>protected final&nbsp;uk.ac.starlink.votable.VOTableVersion votVersion</pre>
<div class="block">VOTable version in which table data must be formatted. By default, it is set to v13.</div>
</li>
</ul>
<a name="mimeType">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mimeType</h4>
<pre>protected&nbsp;java.lang.String mimeType</pre>
<div class="block">MIME type associated with this format.</div>
</li>
</ul>
<a name="shortMimeType">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>shortMimeType</h4>
<pre>protected&nbsp;java.lang.String shortMimeType</pre>
<div class="block">Short form of the MIME type associated with this format.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="VOTableFormat(tap.ServiceConnection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VOTableFormat</h4>
<pre>public&nbsp;VOTableFormat(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service)
              throws java.lang.NullPointerException</pre>
<div class="block"><p>Creates a VOTable formatter.</p>
 
 <p><i>Note:
        The MIME type is automatically set to "application/x-votable+xml" = "votable".
        It is however possible to change this default value thanks to <a href="../../tap/formatter/VOTableFormat.html#setMimeType(java.lang.String,%20java.lang.String)"><code>setMimeType(String, String)</code></a>.
 </i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>service</code> - The service to use (for the log and to have some information about the service (particularly: name, description).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - If the given service connection is <code>null</code>.</dd></dl>
</li>
</ul>
<a name="VOTableFormat(tap.ServiceConnection, uk.ac.starlink.votable.DataFormat)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VOTableFormat</h4>
<pre>public&nbsp;VOTableFormat(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service,
             uk.ac.starlink.votable.DataFormat&nbsp;votFormat)
              throws java.lang.NullPointerException</pre>
<div class="block"><p>Creates a VOTable formatter.</p>
 
 <i>Note: The MIME type is automatically set in function of the given VOTable serialization:</i>
 <ul>
        <li><i><b>none or unknown</b>: equivalent to BINARY</i></li>
        <li><i><b>BINARY</b>:          "application/x-votable+xml" = "votable"</i></li>
        <li><i><b>BINARY2</b>:         "application/x-votable+xml;serialization=BINARY2" = "votable/b2"</i></li>
        <li><i><b>TABLEDATA</b>:       "application/x-votable+xml;serialization=TABLEDATA" = "votable/td"</i></li>
        <li><i><b>FITS</b>:            "application/x-votable+xml;serialization=FITS" = "votable/fits"</i></li>
 </ul>
 <p><i>It is however possible to change these default values thanks to <a href="../../tap/formatter/VOTableFormat.html#setMimeType(java.lang.String,%20java.lang.String)"><code>setMimeType(String, String)</code></a>.</i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>service</code> - The service to use (for the log and to have some information about the service (particularly: name, description).</dd><dd><code>votFormat</code> - Serialization of the VOTable data part. (TABLEDATA, BINARY, BINARY2 or FITS).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - If the given service connection is <code>null</code>.</dd></dl>
</li>
</ul>
<a name="VOTableFormat(tap.ServiceConnection, uk.ac.starlink.votable.DataFormat, uk.ac.starlink.votable.VOTableVersion)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>VOTableFormat</h4>
<pre>public&nbsp;VOTableFormat(<a href="../../tap/ServiceConnection.html" title="interface in tap">ServiceConnection</a>&nbsp;service,
             uk.ac.starlink.votable.DataFormat&nbsp;votFormat,
             uk.ac.starlink.votable.VOTableVersion&nbsp;votVersion)
              throws java.lang.NullPointerException</pre>
<div class="block"><p>Creates a VOTable formatter.</p>
 
 <i>Note: The MIME type is automatically set in function of the given VOTable serialization:</i>
 <ul>
        <li><i><b>none or unknown</b>: equivalent to BINARY</i></li>
        <li><i><b>BINARY</b>:          "application/x-votable+xml" = "votable"</i></li>
        <li><i><b>BINARY2</b>:         "application/x-votable+xml;serialization=BINARY2" = "votable/b2"</i></li>
        <li><i><b>TABLEDATA</b>:       "application/x-votable+xml;serialization=TABLEDATA" = "votable/td"</i></li>
        <li><i><b>FITS</b>:            "application/x-votable+xml;serialization=FITS" = "votable/fits"</i></li>
 </ul>
 <p><i>It is however possible to change these default values thanks to <a href="../../tap/formatter/VOTableFormat.html#setMimeType(java.lang.String,%20java.lang.String)"><code>setMimeType(String, String)</code></a>.</i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>service</code> - The service to use (for the log and to have some information about the service (particularly: name, description).</dd><dd><code>votFormat</code> - Serialization of the VOTable data part. (TABLEDATA, BINARY, BINARY2 or FITS).</dd><dd><code>votVersion</code> - Version of the resulting VOTable.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code> - If the given service connection is <code>null</code>.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getMimeType()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMimeType</h4>
<pre>public final&nbsp;java.lang.String&nbsp;getMimeType()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../tap/formatter/OutputFormat.html#getMimeType()">OutputFormat</a></code></strong></div>
<div class="block">Gets the MIME type corresponding to this format.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../tap/formatter/OutputFormat.html#getMimeType()">getMimeType</a></code>&nbsp;in interface&nbsp;<code><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>Its MIME type (MUST BE DIFFERENT FROM NULL).</dd></dl>
</li>
</ul>
<a name="getShortMimeType()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getShortMimeType</h4>
<pre>public final&nbsp;java.lang.String&nbsp;getShortMimeType()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../tap/formatter/OutputFormat.html#getShortMimeType()">OutputFormat</a></code></strong></div>
<div class="block">Gets a short expression of its MIME type.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../tap/formatter/OutputFormat.html#getShortMimeType()">getShortMimeType</a></code>&nbsp;in interface&nbsp;<code><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>Its short MIME type.</dd></dl>
</li>
</ul>
<a name="setMimeType(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMimeType</h4>
<pre>public final&nbsp;void&nbsp;setMimeType(java.lang.String&nbsp;mimeType,
               java.lang.String&nbsp;shortForm)</pre>
<div class="block"><p>Set the MIME type associated with this format.</p>
 
 <p><i>Note: NULL means no modification of the current value:</i></p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>mimeType</code> - Full MIME type of this VOTable format.  <i>note: if NULL, the MIME type is not modified.</i></dd><dd><code>shortForm</code> - Short form of this MIME type. <i>note: if NULL, the short MIME type is not modified.</i></dd></dl>
</li>
</ul>
<a name="getVotSerialization()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVotSerialization</h4>
<pre>public final&nbsp;uk.ac.starlink.votable.DataFormat&nbsp;getVotSerialization()</pre>
<div class="block">Get the set VOTable data serialization/format (e.g. BINARY, TABLEDATA).</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The data format.</dd></dl>
</li>
</ul>
<a name="getVotVersion()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVotVersion</h4>
<pre>public final&nbsp;uk.ac.starlink.votable.VOTableVersion&nbsp;getVotVersion()</pre>
<div class="block">Get the set VOTable version.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The VOTable version.</dd></dl>
</li>
</ul>
<a name="getDescription()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDescription</h4>
<pre>public&nbsp;java.lang.String&nbsp;getDescription()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../tap/formatter/OutputFormat.html#getDescription()">OutputFormat</a></code></strong></div>
<div class="block">Gets a description of this format.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../tap/formatter/OutputFormat.html#getDescription()">getDescription</a></code>&nbsp;in interface&nbsp;<code><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>Its description.</dd></dl>
</li>
</ul>
<a name="getFileExtension()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileExtension</h4>
<pre>public&nbsp;java.lang.String&nbsp;getFileExtension()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../tap/formatter/OutputFormat.html#getFileExtension()">OutputFormat</a></code></strong></div>
<div class="block">Gets a file extension for this format.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../tap/formatter/OutputFormat.html#getFileExtension()">getFileExtension</a></code>&nbsp;in interface&nbsp;<code><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>Its file extension.</dd></dl>
</li>
</ul>
<a name="writeError(java.lang.String, java.util.Map, java.io.PrintWriter)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeError</h4>
<pre>public&nbsp;void&nbsp;writeError(java.lang.String&nbsp;message,
              java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;otherInfo,
              java.io.PrintWriter&nbsp;writer)
                throws java.io.IOException</pre>
<div class="block"><p>Write the given error message as VOTable document.</p>
 
 <p><i>Note:
        In the TAP protocol, all errors must be returned as VOTable. The class <a href="../../tap/error/DefaultTAPErrorWriter.html" title="class in tap.error"><code>DefaultTAPErrorWriter</code></a> is in charge of the management
        and reporting of all errors. It is calling this function while the error message to display to the user is ready and
        must be written in the HTTP response.
 </i></p>
 
 <p>Here is the XML format of this VOTable error:</p>
 <pre>
        &lt;VOTABLE version="..." xmlns="..." &gt;
                &lt;RESOURCE type="results"&gt;
                        &lt;INFO name="QUERY_STATUS" value="ERROR&gt;
                                ...
                        &lt;/INFO&gt;
                        &lt;INFO name="PROVIDER" value="..."&gt;...&lt;/INFO&gt;
                        &lt;!-- other optional INFOs (e.g. request parameters) --&gt;
                &lt;/RESOURCE&gt;
        &lt;/VOTABLE&gt;
 </pre></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - Error message to display to the user.</dd><dd><code>otherInfo</code> - List of other additional information to display. <i>optional</i></dd><dd><code>writer</code> - Stream in which the VOTable error must be written.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If any error occurs while writing in the given output.</dd><dt><span class="strong">Since:</span></dt>
  <dd>2.0</dd></dl>
</li>
</ul>
<a name="writeResult(tap.data.TableIterator, java.io.OutputStream, tap.TAPExecutionReport, java.lang.Thread)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeResult</h4>
<pre>public final&nbsp;void&nbsp;writeResult(<a href="../../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;queryResult,
               java.io.OutputStream&nbsp;output,
               <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
               java.lang.Thread&nbsp;thread)
                       throws <a href="../../tap/TAPException.html" title="class in tap">TAPException</a>,
                              java.io.IOException,
                              java.lang.InterruptedException</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../tap/formatter/OutputFormat.html#writeResult(tap.data.TableIterator,%20java.io.OutputStream,%20tap.TAPExecutionReport,%20java.lang.Thread)">OutputFormat</a></code></strong></div>
<div class="block"><p>Formats the given query result and writes it in the given output stream.</p>
 
 <p><i>Note: the given output stream should not be closed at the end of this function. It is up to the called to do it.</i></p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../tap/formatter/OutputFormat.html#writeResult(tap.data.TableIterator,%20java.io.OutputStream,%20tap.TAPExecutionReport,%20java.lang.Thread)">writeResult</a></code>&nbsp;in interface&nbsp;<code><a href="../../tap/formatter/OutputFormat.html" title="interface in tap.formatter">OutputFormat</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>queryResult</code> - The raw (table) result to format.</dd><dd><code>output</code> - The output stream (a ServletOutputStream or a stream on a file) in which the formatted result must be written.</dd><dd><code>execReport</code> - The report of the execution of the TAP query whose the result must be now written.</dd><dd><code>thread</code> - The thread which has asked the result writing.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../tap/TAPException.html" title="class in tap">TAPException</a></code> - If there is an error while formatting the query result.</dd>
<dd><code>java.io.IOException</code> - If any error occurs while writing into the given stream.</dd>
<dd><code>java.lang.InterruptedException</code> - If the query has been interrupted/aborted.</dd></dl>
</li>
</ul>
<a name="writeHeader(uk.ac.starlink.votable.VOTableVersion, tap.TAPExecutionReport, java.io.BufferedWriter)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeHeader</h4>
<pre>protected&nbsp;void&nbsp;writeHeader(uk.ac.starlink.votable.VOTableVersion&nbsp;votVersion,
               <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
               java.io.BufferedWriter&nbsp;out)
                    throws java.io.IOException,
                           <a href="../../tap/TAPException.html" title="class in tap">TAPException</a></pre>
<div class="block"><p>Writes the first VOTable nodes/elements preceding the data: VOTABLE, RESOURCE and 3 INFOS (QUERY_STATUS, PROVIDER, QUERY).</p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>votVersion</code> - Target VOTable version.</dd><dd><code>execReport</code> - The report of the query execution.</dd><dd><code>out</code> - Writer in which the root node must be written.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If there is an error while writing the root node in the given Writer.</dd>
<dd><code><a href="../../tap/TAPException.html" title="class in tap">TAPException</a></code> - If there is any other error (by default: never happen).</dd></dl>
</li>
</ul>
<a name="toColumnInfos(tap.data.TableIterator, tap.TAPExecutionReport, java.lang.Thread)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toColumnInfos</h4>
<pre>public static final&nbsp;uk.ac.starlink.table.ColumnInfo[]&nbsp;toColumnInfos(<a href="../../tap/data/TableIterator.html" title="interface in tap.data">TableIterator</a>&nbsp;result,
                                              <a href="../../tap/TAPExecutionReport.html" title="class in tap">TAPExecutionReport</a>&nbsp;execReport,
                                              java.lang.Thread&nbsp;thread)
                                                             throws java.io.IOException,
                                                                    <a href="../../tap/TAPException.html" title="class in tap">TAPException</a>,
                                                                    java.lang.InterruptedException</pre>
<div class="block">Writes fields' metadata of the given query result.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>result</code> - The query result from whose fields' metadata must be written.</dd><dd><code>execReport</code> - The report of the query execution.</dd><dd><code>thread</code> - The thread which asked for the result writing.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Extracted field's metadata, or NULL if no metadata have been found (theoretically, it never happens).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If there is an error while writing the metadata.</dd>
<dd><code><a href="../../tap/TAPException.html" title="class in tap">TAPException</a></code> - If there is any other error.</dd>
<dd><code>java.lang.InterruptedException</code> - If the given thread has been interrupted.</dd></dl>
</li>
</ul>
<a name="getValidColMeta(adql.db.DBColumn, tap.metadata.TAPColumn)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValidColMeta</h4>
<pre>protected static final&nbsp;<a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a>&nbsp;getValidColMeta(<a href="../../adql/db/DBColumn.html" title="interface in adql.db">DBColumn</a>&nbsp;typeFromQuery,
                        <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a>&nbsp;typeFromResult)</pre>
<div class="block">Try to get or otherwise to build appropriate metadata using those extracted from the ADQL query and those extracted from the result.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>typeFromQuery</code> - Metadata extracted/guessed from the ADQL query.</dd><dd><code>typeFromResult</code> - Metadata extracted/guessed from the result.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The most appropriate metadata.</dd></dl>
</li>
</ul>
<a name="getColumnInfo(tap.metadata.TAPColumn)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getColumnInfo</h4>
<pre>protected static final&nbsp;uk.ac.starlink.table.ColumnInfo&nbsp;getColumnInfo(<a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata">TAPColumn</a>&nbsp;tapCol)</pre>
<div class="block">Convert the given <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata"><code>TAPColumn</code></a> object into a <code>ColumnInfo</code> object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tapCol</code> - <a href="../../tap/metadata/TAPColumn.html" title="class in tap.metadata"><code>TAPColumn</code></a> to convert into <code>ColumnInfo</code>.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The corresponding <code>ColumnInfo</code>.</dd></dl>
</li>
</ul>
<a name="getDatatypeClass(tap.metadata.VotType.VotDatatype, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDatatypeClass</h4>
<pre>protected static final&nbsp;java.lang.Class&lt;?&gt;&nbsp;getDatatypeClass(<a href="../../tap/metadata/VotType.VotDatatype.html" title="enum in tap.metadata">VotType.VotDatatype</a>&nbsp;datatype,
                                  java.lang.String&nbsp;arraysize)</pre>
<div class="block">Convert the VOTable datatype string into a corresponding <code>Class</code> object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datatype</code> - Value of the VOTable attribute "datatype".</dd><dd><code>arraysize</code> - Value of the VOTable attribute "arraysize".</dd>
<dt><span class="strong">Returns:</span></dt><dd>The corresponding <code>Class</code> object.</dd></dl>
</li>
</ul>
<a name="getShape(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getShape</h4>
<pre>protected static final&nbsp;int[]&nbsp;getShape(java.lang.String&nbsp;arraysize)</pre>
<div class="block">Convert the given VOTable arraysize into a <code>ColumnInfo</code> shape.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>arraysize</code> - Value of the VOTable attribute "arraysize".</dd>
<dt><span class="strong">Returns:</span></dt><dd>The corresponding <code>ColumnInfo</code> shape.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/VOTableFormat.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../tap/formatter/TextFormat.html" title="class in tap.formatter"><span class="strong">Prev Class</span></a></li>
<li><a href="../../tap/formatter/VOTableFormat.LimitedStarTable.html" title="class in tap.formatter"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?tap/formatter/VOTableFormat.html" target="_top">Frames</a></li>
<li><a href="VOTableFormat.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
